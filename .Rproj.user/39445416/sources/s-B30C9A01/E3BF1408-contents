% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seqTrunSPMLE.R
\name{seqTrunSPMLE}
\alias{seqTrunSPMLE}
\title{Semiparametric Maximum Likelihood Estimation Under Sequential Truncation}
\usage{
seqTrunSPMLE(data, a, v, t.a, B)
}
\arguments{
\item{data}{dataframe containing \eqn{(L,X,R)} on columns 1,2,3 respectively.}

\item{a}{the point on which the cumulative distribution function (CDF) of \eqn{L} is evaluated.}

\item{v}{the intervals of the piecewise exponential distribution.}

\item{t.a}{the upper limit of \eqn{L} to be evaluated.}

\item{B}{the number of boostrap replications.}
}
\value{
The output contains the following components:
\describe{
  \item{Evaluation point}{the points on which we estimate the CDF of \eqn{L}.}
  \item{Point estimate}{the estimate of the CDF of \eqn{L}.}
  \item{Bootstrap SE}{the standard error estimated by a bayesian bootstrap procedure.}
  \item{Truncation probability}{the probability of \eqn{X>R}.}
}
}
\description{
\code{seqTrunSPMLE} provides semiparametric maximum likelihood estimate for the distribution
     of \eqn{L} under the sequential truncation model \eqn{(L,X)} is independent of \eqn{R}
     given \eqn{L<X<R}, and \eqn{P(L<X)=1}. Variance estimation is also evaluated by a nonparametric
     bootstrap procedure.
}
\examples{
fn_data <- function(l.shape,l.rate,u.start,u.end,r.shape,r.rate,n){
  temp.dat <- matrix(0,n,3)
  i<-1
  while (i <=n) {
    l <- rgamma(1,l.shape,l.rate)
    u <- runif(1,u.start,u.end)
    r <- rgamma(1,r.shape,r.rate)
    x <- round(l + u,5)
    if(x<=r&(x\\%in\\%temp.dat[,2]==FALSE)){
      temp.dat[i,] <- c(l,x,r)
      i<-i+1
    }
  }
  return(as.matrix(temp.dat))
}
l.shape <- 26
l.rate <- 0.5
u.start <- 0
u.end <- 3
n=200
r.shape <- 20
r.rate <- 0.5
dat <- fn_data(l.shape,l.rate,u.start,u.end,r.shape,r.rate,n)
p0=pgamma(58.09,l.shape,l.rate)
a=qgamma(seq(0.05,1,0.05)*p0,l.shape,l.rate)
t.a=qgamma(p0,l.shape,l.rate)
B=5
v=quantile(dat[,3],probs = seq(0,1,0.1))

seqTrunSPMLE(dat,a,v,t.a,B)


}
\references{
Betensky R. A., Qian, J. and Hou, J. (2022), Nonparametric and semiparametric
    estimation with sequentially truncated survival data. (Techincal Report)
}
