% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/seqTrunNPMLE.R
\name{seqTrunNPMLE}
\alias{seqTrunNPMLE}
\title{Nonparametric Maximum Likelihood Estimation Under Sequential Truncation}
\usage{
seqTrunNPMLE(data, a, t.a, B, V)
}
\arguments{
\item{data}{dataframe containing \eqn{(L,X,R)} on columns 1,2,3 respectively.}

\item{a}{the point on which the cumulative distribution function (CDF) of \eqn{L} is evaluated.}

\item{t.a}{the upper limit of \eqn{L} to be evaluated.}

\item{B}{the number of boostrap replications.}

\item{V}{the indicator of whether analytical variance is computed.}
}
\value{
The output contains the following components:
\describe{
  \item{Evaluation point}{the points on which we estimate the CDF of \eqn{L}.}
  \item{Point estimate}{the estimate of the CDF of \eqn{L}.}
  \item{Bootstrap SE}{the standard error estimated by a bayesian bootstrap procedure.}
  \item{Analytical SE}{the standard error estimated by the proposed method.}
  \item{Truncation probability}{the probability of \eqn{X>R}.}
}
}
\description{
\code{seqTrunNPMLE} provides nonparametric maximum likelihood estimate for the distribution
     of \eqn{L} under the sequential truncation model \eqn{(L,X)} is independent of \eqn{R}
     given \eqn{L<X<R}, and \eqn{P(L<X)=1}. Variance estimation is also evaluated by a nonparametric
     bootstrap procedure and an analytical method based on asymptotic properties of the estimator.
}
\examples{
fn_data <- function(l.shape,l.rate,u.start,u.end,r.shape,r.rate,n){
  temp.dat <- matrix(0,n,3)
  i<-1
  while (i <=n) {
    l <- rgamma(1,l.shape,l.rate)
    u <- runif(1,u.start,u.end)
    r <- rgamma(1,r.shape,r.rate)
    x <- round(l + u,5)
    if(x<=r&(x\%in\%temp.dat[,2]==FALSE)){
      temp.dat[i,] <- c(l,x,r)
      i<-i+1
    }
  }
  return(as.matrix(temp.dat))
}

l.shape <- 26
l.rate <- 0.5
u.start <- 0
u.end <- 3
n=200
#P(X<R)=15\%
r.shape <- 20
r.rate <- 0.5
dat <- fn_data(l.shape,l.rate,u.start,u.end,r.shape,r.rate,n)
p0=pgamma(58.09,l.shape,l.rate)
a=qgamma(seq(0.05,1,0.05)*p0,l.shape,l.rate)
t.a=qgamma(p0,l.shape,l.rate)
B=5
V=1

seqTrunNPMLE(dat,a,t.a,B,V)

}
\references{
Betensky R. A., Qian, J. and Hou, J. (2022), Nonparametric and semiparametric
    estimation with sequentially truncated survival data. (Techincal Report)
}
